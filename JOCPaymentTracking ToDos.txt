=======================================================================================
LIVE SPREADSHEET as reference: https://nycep-my.sharepoint.com/:x:/g/personal/heimj_dep_nyc_gov/EVk-Wko9ZU5Ap-FbB6_pLhkBOJYFR1Ld0Rwlc71UEAwZtw?e=4%3AisT52w&CID=0e5aa3a8-1f60-3935-128d-a804efb72a47&ovuser=f470a35f-0853-4633-aae3-ce4e8b5085a3%2Cbchiu%40dep.nyc.gov&clickparams=eyJBcHBOYW1lIjoiVGVhbXMtRGVza3RvcCIsIkFwcFZlcnNpb24iOiIyNy8yMzA2MDQwMTEzOCIsIkhhc0ZlZGVyYXRlZFVzZXIiOmZhbHNlfQ%3D%3D

NOTE: https://www.endpointdev.com/blog/2021/09/deploying-dotnet-5-app-iis/
NOTE: need to remove OLD CRT permissions JOC DB
NOTE: seems to be useful NTLM insight https://www.youtube.com/watch?v=gWfpYAjBeOA
NOTE: https://learn.microsoft.com/en-us/aspnet/mvc/overview/older-versions-1/security/authenticating-users-with-windows-authentication-cs

NOTE: enabled IIS Express window authentication - did it but does not seems to work
https://dotnetthoughts.net/how-to-enable-windows-authentication-in-iis-express/

NOTE: #has to be compile in release mode and not debug mode to refresh the program references.
=========================================================================================
9-19-2023
# implimented new code to the Home controller
--> waiting on XING and KURU to get back to me to see if the app is able to capture their names after windows login

9-18-2023
# using _httpContextAccessor.HttpContext.User.Identity.Name; 
--> still comes out NULL on the server

#https://github.com/thepirat000/Audit.NET/tree/master/src/Audit.EntityFramework#entity-framework-data-provider
--> FOUND: http://deptfspapp01:8080/tfs/BWT/Bypass/_search?action=contents&text=HttpContextAccessor&type=code&lp=code-Project&filters=ProjectFilters%7BBypass%7DRepositoryFilters%7BBypass%7D&pageSize=25&result=DefaultCollection%2FBypass%2FBypass%2FGBmaster%2F%2Fsrc%2FBypass.OData%2FStartup.cs

9-14-2023
#lfkqbwtweb02 copied contents of ccase-api-uat to ntlm-test
--> appPool settings: net4 intergrated using applicationPoolIdentity
--> clear cache / incognito 
--> using my local machine web browser: http://lfkqbwtweb02/ntlm-test/api/values
--> ntlm prompt appeared
#lfkqbwtweb02 copied contents of ccase-api-uat to ntlm-test
--> appPool settings: not-managed classic using applicationPoolIdentity
--> clear cache / incognito 
--> using my local machine web browser: http://lfkqbwtweb02/ntlm-test/api/values
--> ntlm prompt appeared
#lfkqbwtweb02 remove all contents of ntlm-test
--> appPool settings: not-managed classic using applicationPoolIdentity
--> clear cache / incognito 
--> using my local machine web browser: http://lfkqbwtweb02/ntlm-test/
--> ntlm prompt appeared
#lfkqbwtweb02 with index.html hello world text of ntlm-test
--> appPool settings: not-managed classic using applicationPoolIdentity
--> clear cache / incognito 
--> using my local machine web browser: http://lfkqbwtweb02/ntlm-test/ or http://lfkqbwtweb02/ntlm-test/index.html
--> ntlm prompt appeared
--> when i logged in i did see the contents of hello world

#http://depqbwtweb01/ with my net5 barebone weather app in ntlm-test
--> appPool settings: net4 intergrated using applicationPoolIdentity
--> clear cache / incognito 
--> using my local machine web browser: http://depqbwtweb01/ntlm-test did not auto redirect to weatherforecast
--> using my local machine web browser: http://depqbwtweb01/ntlm-test/weatherforecast
--> ntlm prompt appeared
--> when i logged in i did see the contents of hello world

#http://depqbwtweb01/jpt-dev-api
--> appPool settings: net4 intergrated using applicationPoolIdentity
--> clear cache / incognito 
--> using my local machine web browser: http://depqbwtweb01/jpt-dev-api/api/homeapi
--> no ntlm prompt appeared
--> error: This page isn’t workingdepqbwtweb01 is currently unable to handle this request.


9/13/2023
#appPool using ds\bwtapplication because NTLM is not currently working to grab the current user
--> this worked: http://localhost:5000/api/HomeAPI/username is working
--> this did not work http://localhost:5000/api/HomeAPI is working
--> this did not work http://localhost:5000/api/PermissionsAPI with This page isn’t working right now
----> db user logs access denied
--> NEED TO GET NTLM WORKING !!! 
--> Leaving this UAT version for Kuru to use
--> create DEV version to test
--> need to remove OLD CRT permissions 

9/12/2023
#tested dotnet webapi on lfkqbwtweb02 - this web server does not have the net5,6,7 hosting package installed
--> this worked: http://localhost:5000/api/HomeAPI/username
--> this did not work http://localhost:5000/api/HomeAPI with 404 error
--> this did not work http://localhost:5000/api/PermissionsAPI with 404 error

9/11/2023
#Installed Microsoft.AspNetCore.Authentication.Negotiate
--> need to config it so NTLM will prompt.

ef db into project.
need to create controllers for the new models 
9/8/2023 using custom tool namespace for appsettings.json need to test this. 
NTLM is not being triggered on the webserver.


9/7/2023
#test to server does work NET5 for this application. ran test with dotnet webapi.dll
--> need to play with how to place and call appsettings.json when it publishes to the server and when testing locally
#test published files
--> https://stackoverflow.com/questions/67211060/http-error-500-30-asp-net-core-5-app-failed-to-start
--> CMD: C:\inetpub\wwwroot\jpt-api-uat
--> CMD: dotnet webapi.dll
--> BROSER working: http://localhost:5000/api/HomeAPI
--> BROSER working: http://localhost:5000/api/PermissionsAPI
#testing to IIS
--> BROSER working: http://localhost/jpt-api-uat/api/HomeAPI
--> BROSER NOT working: http://localhost/jpt-api-uat/api/PermissionsAPI

9-6-2023
#test published files
--> https://stackoverflow.com/questions/67211060/http-error-500-30-asp-net-core-5-app-failed-to-start
--> CMD: cd C:\BDEV\JOCPaymentTracking\Published
--> CMD: dotnet webapi.dll
--> BROSER: http://localhost:5000/api/HomeAPI
--> BROSER: http://localhost:5000/api/PermissionsAPI
#tried on webserver - didnt work.
#tried ccase - seems to work.
#web server is win10 x64 - republish for that and try again


9-5-2023 publishing only publishes the first controller and stalls. no errors given. just takes 25mins on server. 3 mins locally.
endpoints not being published or ignored

https://learn.microsoft.com/en-us/aspnet/core/mvc/controllers/routing?view=aspnetcore-5.0

Routing is configured using the UseRouting, MapControllerRoute, and MapAreaControllerRoute middleware . To use controllers:

Call MapControllers inside UseEndpoints to map attribute routed controllers.
Call MapControllerRoute or MapAreaControllerRoute, to map both conventionally routed controllers and attribute routed controllers.